<script src="http://code.jquery.com/jquery-1.9.0.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">

<dom-module id="morris-donut-chart">
    <template>
        <style include="">
            :host {
                width: 100%;
                height: 100px;
                text-align: center;
                position: relative;
            }
            .big{
                height: 100px;
                overflow: auto;
            }

        </style>

        <iron-ajax
                id="morrisChartData"
                url="{{tempUrl}}"
                handle-as="json"
                on-request="startRequest"
                on-response="parseResponse"
                ></iron-ajax>

        <div class="big">
            Morris component
            <div id="donut-example"></div>
        </div>
    </template>
</dom-module>

<script>
    Polymer({
        is: 'morris-donut-chart',
        properties: {
            elements: String,
            pressed: {
                type: Boolean,
                value: false,
                notify: true,
                reflectToAttribute: true
            }
        },
        listeners: {
            'tap': 'toggle'
        },
        toggle: function() {
            this.pressed = !this.pressed;
        },
        attached: function() {
            console.debug(this['is'], "ready!;" );

            // make AJAX REQUEST
            this.data =  [
                {"value": 60, "label": "Opened"},
                {"value": 25, "label": "Visit website"},
                {"value": 10, "label": "Registered"},
                {"value": 5, "label": "Deleted"}
            ]


            Morris.Donut({
                element: 'donut-example',
                resize: true,
                data: this.data,
                formatter: function (x) { return x + "%"}
            }).on('click', function(i, row){
                console.log(i, row);
            });

        }
    });

</script>
